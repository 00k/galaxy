
package galaxy;

option cc_generic_services = true;

enum MasterCommandType {
    HEART_BEAT = 0,
    // Task control
    LAUNCH_TASK = 1,
    TERMINATE_TASK = 2,
};

message HeartBeatRequest {
    required string agent_addr = 1;
    required int32 agent_id = 2;
    repeated TaskStatus task_status_list = 3;
    // the total_resource is a list which includes 
    // memory and cpu 
    repeated ResourceItem total_resource_list = 4;
    // the used_resource counts memory ,cpu and port
    repeated ResourceItem used_resource_list = 5;
    
}
message HeartBeatResponse {
    optional int32 agent_id = 1;
    optional MasterCommandType = 2;
}

message TaskInfo{
    required int64 task_id = 1 ;
    required string package_src = 2;
    required string cmd_line = 3 ;
}

message TaskStatus{
    required int64 task_id = 1 ;
    //deploying,starting,running,error
    required int32 status = 2;
}

message ResourceItem{
    //Name could  be memory,cpu or port 
    required string name = 1;
    required int64 value = 2;
}



service Master {
    rpc HeartBeat(HeartBeatRequest) returns(HeartBeatResponse);
}

